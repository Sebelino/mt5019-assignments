---
title: "Computer Assignment 2"
author:
  - "Ville Sebastian Olsson (19911231-1999)"
  - "Arvind Guruprasad (19990212-6938)"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_caption: true
  pdf_document:
    fig_caption: true
---

```{r, echo=FALSE, results='hide', fig.show='hide'}
source("assignment2.R")
list2env(ass, envir = .GlobalEnv)
knitr::opts_chunk$set(echo = FALSE, comment = "")
```

# Exercise 2:1

## 1.

We are computing estimates of the intercept parameter and the effect parameter: \(\hat\beta_0\) and \(\hat\beta_1\), respectively.

The estimates are given by fitting a logistic regression
model and fetching the coefficients of the model.

```{r}
coef(model21)
```

\(\hat\beta_0\): This is the estimated log-odds of periodontitis for those who do not use floss.

We can exponentiate the log-odds to get the odds:

\[\text{odds} = e^{\hat\beta_0}\]
Numerically computed odds:
```{r}
exp(coef(model21)["(Intercept)"])
```

This suggests that for non-floss users, the odds of having periodontitis are about 0.558.

\(\hat\beta_1\): This indicates that floss usage is associated with lower odds of periodontitis. The negative value suggests that floss users are less likely to have periodontitis compared to non-users.

Exponentiating this coefficient gives the odds ratio for floss users compared to non-users:

\[\text{odds} = e^{\hat\beta_1}\]
Numerically computed odds:
```{r}
exp(coef(model21)["useYes"])
```

This means that floss users have approximately 52.5% of the odds of having periodontitis compared to non-users, suggesting a protective effect of flossing against periodontitis.

## 2.

The estimates are given by fitting a logistic regression model and fetching the coefficients of the model:
```{r}
coef(model21b)
```

\(\gamma_0\): This coefficient represents the log-odds of using dental floss for individuals without periodontitis.

Exponentiating gives the baseline odds of floss usage among those without periodontitis:

\[\text{odds} = e^{\hat\beta_0}\]
Numerically computed odds:
```{r}
exp(coef(model21b)["(Intercept)"])
```

This suggests that for individuals without periodontitis, the odds of using dental floss are approximately 0.283.

\(\gamma_1\): This coefficient represents the change in log-odds of floss usage when periodontitis is present compared to when it is absent.
Since \(\gamma_1\) is negative, it indicates that individuals with periodontitis are less likely to use dental floss compared to those without periodontitis.

\[\text{odds} = e^{\hat\beta_1}\]
Numerically computed odds:
```{r}
exp(coef(model21b)["perYes"])
```

This odds ratio of 0.525 means that individuals with periodontitis have 52.5% of the odds of using dental floss compared to individuals without periodontitis. In other words, individuals with periodontitis are less likely to use dental floss than those without it.

## 3.

The estimate for \( \beta_1 \) is the difference in log-odds of periodontitis between floss users and non-floss users:

For \(\beta\):

\[
\beta_1 = \log \left( \frac{\text{odds of floss for peridontitis users}}{\text{odds of floss for non-periodontitis users}} \right)
\]

\[
\text{odds}_{\text{floss}} = \frac{22}{75} \approx 0.2933
\]

For individuals without floss:
\[
\text{odds}_{\text{no floss}} = \frac{148}{265} \approx 0.5585
\]

The coefficient \( \beta_1 \) is given by:
\[
\beta_1 = \log \left( \frac{0.2933}{0.5585} \right) = \log(0.525) \approx -0.6439
\]

Numerical result:
```{r}
odds_floss <- 22 / 75
odds_no_floss <- 148 / 265
logratio <- log(odds_floss / odds_no_floss)
logratio
```

For \(\gamma\):

\[
\gamma_1 = \log \left( \frac{\text{odds of periodontitis for floss users}}{\text{odds of periodontitis for non-floss users}} \right)
\]

\[
\text{odds}_{\text{periodontitis}} = \frac{22}{148} \approx 0.1486
\]

For individuals without periodontitis:
\[
\text{odds}_{\text{no periodontitis}} = \frac{75}{265} \approx 0.2830
\]

The coefficient \( \gamma_1 \) is given by:
\[
\gamma_1 = \log \left( \frac{0.1486}{0.2830} \right) = \log(0.525) \approx -0.6439
\]

Numerical result:
```{r}
odds_periodontitis <- 22 / 148
odds_no_periodontitis <- 75 / 265
logratio <- log(odds_periodontitis / odds_no_periodontitis)
logratio
```

Both \( \beta_1 \) and \( \gamma_1 \) are calculated as the log of the same odds ratio, \( \log(0.525) \), resulting in:

\[
\beta_1 = \gamma_1 \approx -0.6439
\]

Thus, we have shown that \( \beta_1 \) and \( \gamma_1 \) are indeed equal. This equality holds because both logistic models are derived from the same underlying contingency table, just with the roles of the variables swapped.


# Exercise 2:2

## 1.

For each dose, the probability of developing a tumor is given by:

\[
\text{Risk} = \frac{\text{Tumor}}{\text{Total}}
\]
where \textit{Total} is the sum of "Tumor" and "No Tumor" counts for each dose level.

\subsection*{Odds of Tumor for Each Dose}
The odds for each dose level can be calculated as:
\[
\text{Log-Odds} = \log \left( \frac{\text{Tumor} / \text{Total}}{1 - (\text{Tumor} / \text{Total})} \right)
\]

We now plot the risk against the log-dose and log-odds against the log-dose:

```{r, align='center'}
plot_risk(log_dose, risk)
```

This plot shows the probability (or risk) of developing a tumor at different log(dose) levels.
As the log(dose) increases, the risk of developing a tumor also increases. This suggests a positive association between dose and tumor risk; higher doses are associated with a greater likelihood of developing a tumor.
The increase in risk appears to follow a smooth trend, becoming especially steep for higher log(dose) values.

```{r, align='center'}
plot_odds(log_dose, log_odds)
```

This plot shows the relationship between log(dose) and the log-odds of developing a tumor.
The log-odds appear to increase in an approximately linear fashion as log(dose) increases. The points follow a roughly straight line, which is a key indicator of a linear relationship.
This linear trend in the log-odds plot suggests that a logistic regression model may be appropriate for modeling the relationship between log(dose) and the probability of developing a tumor. In logistic regression, we assume that the log-odds of the outcome is linearly related to the explanatory variable, and this plot supports that assumption.

Since the log-odds plot shows a roughly linear trend with log(dose), a logistic regression model seems appropriate for these data. The linearity in the log-odds plot indicates that the assumption of logistic regression (a linear relationship between log-odds and the predictor) is likely met. This model would allow us to quantify the effect of dose on the probability of developing a tumor.

## 2.

We now fit a logistic regression model to the data
to estimate the relationship between does and
the log-odds of developing a tumor.

\(\hat\beta_0\): This represents the log-odds of developing a tumor when the log(dose) is zero. Although it has a mathematical interpretation, it may not have a direct practical meaning in this context, especially if log(dose) = 0 is outside the range of observed values.

\(\hat\beta_1\): The slope tells us how the log-odds of developing a tumor change with each unit increase in log(dose). If \(\hat\beta_1\) is positive, this implies that as log(dose) increases, the log-odds of developing a tumor also increase, indicating a higher probability of tumor development at higher doses.

```{r}
coef(model22)
```

By exponentiating, we obtain the odds:
```{r}
exp(coef(model22)["(Intercept)"])
```
This means that, at a log_dose of zero, the odds of developing a tumor are approximately 1.99.

```{r}
exp(coef(model22)["log_dose"])
```
The positive slope of 0.5204 indicates a strong association between increasing dose levels and a higher likelihood of tumor development.
The odds value of \(1.682\) means that for each one-unit increase in log_dose, the odds of developing a tumor increase by approximately 68.2%. In other words, higher doses are associated with a significantly higher risk of developing a tumor.

## 3.

Covariance matrix:
```{r}
cov_matrix
```
The diagonal of the covariance matrix
represents the variance of the intercept and the log dose,
respectively.
The off-diagonal elements represent the covariance.
This value indicates the degree to which the intercept and slope vary together.
The off-diagonal values are not zero, meaning that
they are not independent.

The correlation coefficient is given by:
\[\text{Correlation} = \frac{\text{Covariance}}{\text{Standard Error of Intercept} \times \text{Standard Error of Slope}}\]

```{r}
correlation
```
A correlation of approximately 
0.649 indicates a moderate positive correlation between the intercept and slope estimates.
This suggests that the intercept and slope estimates are not completely independent; as one estimate increases, the other tends to increase as well. In practical terms, this moderate correlation is not unusual in logistic regression and does not typically indicate an issue with the model. However, it is useful to be aware of this correlation, especially if we are interpreting the parameters separately.

Confidence interval for the intercept and slope parameter:
```{r}
conf_intervals
```

This interval tells us that we are 95% confident that the true value of the intercept parameter \(\beta_0\) lies between 0.1822 and 1.1918.
In terms of log-odds, the intercept represents the log-odds of developing a tumor when log(dose) = 0.

This interval tells us that we are 95% confident that the true value of the slope parameter \(\beta_1\) lies between 0.3537 and 0.6870.
The slope represents the change in log-odds of developing a tumor for each one-unit increase in log(dose).

Confidence interval for the tumor risk at dose 0.25:
```{r}
probability_ci
```
This interval tells us that we are 95% confident that the true probability of developing a tumor at log(dose) = -1.39 lies between 0.394 (39.4%) and 0.588 (58.8%).
Since this interval is relatively wide, it reflects some uncertainty in the exact probability estimate but still suggests a moderate to high likelihood of tumor development at this dose level.

...
